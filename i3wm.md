---
title: i3wm
mathjax: true
tags: [ubuntu,i3]
date: 2022-06-22 13:34:38
categories: ubuntu
description: 窗口管理器i3wm安装配置
---

可以借鉴的配置：
https://github.com/aeghn/prettyi3
https://github.com/jorhelp/LinuxDotfiles

# i3wm

https://github.com/i3/i3

## i3-gaps

i3-gaps 可以使窗口之间有空隙（最终使用）
https://github.com/Airblader/i3

## i3-gaps-rounded

在i3-gaps的基础之上添加了圆角，有bug，圆角不能正常显示
https://github.com/resloved/i3

## 配置i3

创建配置文件: `~/.config/i3/config`

```config
# This file has been auto-generated by i3-config-wizard(1).
# It will not be overwritten, so edit it as you like.
#
# Should you change your keyboard layout some time, delete
# this file and re-run i3-config-wizard(1).
#

# i3 config file (v4)
#
# Please see https://i3wm.org/docs/userguide.html for a complete reference!

set $mod Mod4

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
font pango:monospace 8

# new window
new_window none
new_float normal
hide_edge_borders both

gaps inner 8

#border_radius 5

# This font is widely installed, provides lots of unicode glyphs, right-to-left
# text rendering and scalability on retina/hidpi displays (thanks to pango).
#font pango:DejaVu Sans Mono 8

# Before i3 v4.8, we used to recommend this one as the default:
# font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1
# The font above is very space-efficient, that is, it looks good, sharp and
# clear in small sizes. However, its unicode glyph coverage is limited, the old
# X core fonts rendering does not support right-to-left and this being a bitmap
# font, it doesn’t scale on retina/hidpi displays.

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod


#bindsym $mod+n exec jupyter notebook



# start a terminal
#bindsym $mod+Return exec i3-sensible-terminal
#bindsym $mod+Return exec terminator
bindsym $mod+Return exec --no-startup-id alacritty

# kill focused window
bindsym $mod+Shift+q kill

# start dmenu (a program launcher)
#bindsym $mod+d exec dmenu_run
# There also is the (new) i3-dmenu-desktop which only displays applications
# shipping a .desktop file. It is a wrapper around dmenu, so you need that
# installed.
## bindsym $mod+d exec --no-startup-id i3-dmenu-desktop
#
bindsym $mod+d exec --no-startup-id rofi -theme slate.rasi -show combi -show-icons
#

# change focus
#bindsym $mod+j focus left
#bindsym $mod+k focus down
#bindsym $mod+l focus up
#bindsym $mod+semicolon focus right
#
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# alternatively, you can use the cursor keys:
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# split in horizontal orientation
#bindsym $mod+shift+h split h

# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
#bindsym $mod+d focus child

# switch to workspace
bindsym $mod+1 workspace 1
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9
bindsym $mod+0 workspace 10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace 1
bindsym $mod+Shift+2 move container to workspace 2
bindsym $mod+Shift+3 move container to workspace 3
bindsym $mod+Shift+4 move container to workspace 4
bindsym $mod+Shift+5 move container to workspace 5
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9
bindsym $mod+Shift+0 move container to workspace 10

# reload the configuration file
bindsym $mod+Shift+c reload
# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart
# exit i3 (logs you out of your X session)
bindsym $mod+Shift+e exec "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'"

# resize window (you can also use the mouse for that)
mode "resize" {
        # These bindings trigger as soon as you enter the resize mode

        # Pressing left will shrink the window’s width.
        # Pressing right will grow the window’s width.
        # Pressing up will shrink the window’s height.
        # Pressing down will grow the window’s height.
        bindsym h resize shrink width 10 px or 10 ppt
        bindsym j resize grow height 10 px or 10 ppt
        bindsym k resize shrink height 10 px or 10 ppt
        bindsym l resize grow width 10 px or 10 ppt

        # same bindings, but for the arrow keys
        bindsym Left resize shrink width 10 px or 10 ppt
        bindsym Down resize grow height 10 px or 10 ppt
        bindsym Up resize shrink height 10 px or 10 ppt
        bindsym Right resize grow width 10 px or 10 ppt

        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Caps_Lock mode "default"
}

bindsym $mod+r mode "resize"

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
#bar {
#status_command i3status
#status_command polybar
#}


for_window [class="netease-cloud-music"] floating enable
#for_window [class="qv2ray"] floating enable


bindsym $mod+b exec --no-startup-id firefox
bindsym ctrl+Mod1+a exec --no-startup-id flameshot gui
bindsym XF86MonBrightnessUp exec "xbacklight -inc 10; notify-send 'brightness up'"
bindsym XF86MonBrightnessDown exec "xbacklight -dec 10; notify-send 'brightness down'"

bindsym XF86AudioRaiseVolume exec amixer set  Master 1dB+
bindsym XF86AudioLowerVolume exec amixer set  Master 1dB-
bindsym XF86AudioMute exec amixer -D pulse set Master toggle 


exec_always --no-startup-id xrandr --output HDMI-0 --primary 
exec_always --no-startup-id xrandr --output DP-2 --right-of HDMI-0

exec_always --no-startup-id feh --bg-scale ~/Pictures/background.png

exec_always --no-startup-id ~/.config/i3/polybar.sh &
exec_always --no-startup-id ~/.config/i3/tap2click.sh &
exec_always --no-startup-id ~/.config/i3/inverse-scroll.sh &

exec --no-startup-id picom -b

```
# compton & picom

使用picom实现阴影，透明，高斯模糊，圆角效果

## 安装picom

- 原生picom，功能少，bug少
https://github.com/yshui/picom

- 增加了透明、高斯模糊、圆角
但是有一个问题，同时使用圆角，透明+高斯模糊，阴影时，圆角处不透明而是模糊效果
https://github.com/ibhagwan/picom 

- 修复了圆角处的问题（最终使用）
https://github.com/s0nny7/picom

- 带动画的picom，我用不了，会报错
https://github.com/jonaburg/picom

## 配置picom
`~/.config/picom/picom.conf`

```config
#################################
#          Animations           #
#################################
# requires https://github.com/jonaburg/picom
# (These are also the default values)
transition-length = 300
transition-pow-x = 0.1
transition-pow-y = 0.1
transition-pow-w = 0.1
transition-pow-h = 0.1
size-transition = true


##################################
##             Corners           #
##################################
## requires: https://github.com/sdhand/compton or https://github.com/jonaburg/picom
corner-radius = 10.0;
rounded-corners-exclude = [
#  "class_g = 'awesome'",
#  #"window_type = 'normal'",
#  "class_g = 'awesome'",
#  "class_g = 'URxvt'",
#  "class_g = 'XTerm'",
#  "class_g = 'kitty'",
#  "class_g = 'Alacritty'",
    "class_g = 'Polybar'"
#  "class_g = 'code-oss'",
#  #"class_g = 'TelegramDesktop'",
#  "class_g = 'firefox'",
#  "class_g = 'Thunderbird'"
];
round-borders = 1;
round-borders-exclude = [
#  #"class_g = 'TelegramDesktop'",
    "class_g = 'Polybar'"

];
#
##################################
##             Shadows           #
##################################
#
#
## Enabled client-side shadows on windows. Note desktop windows 
## (windows with '_NET_WM_WINDOW_TYPE_DESKTOP') never get shadow, 
## unless explicitly requested using the wintypes option.
##
## shadow = false
shadow = true;
#
## The blur radius for shadows, in pixels. (defaults to 12)
## shadow-radius = 12
#shadow-radius = 17;
#
## The opacity of shadows. (0.0 - 1.0, defaults to 0.75)
shadow-opacity = 0.75
#
## The left offset for shadows, in pixels. (defaults to -15)
## shadow-offset-x = -15
shadow-offset-x = -7;
#shadow-offset-x = -17;
#
## The top offset for shadows, in pixels. (defaults to -15)
## shadow-offset-y = -15
shadow-offset-y = -7;
#shadow-offset-y = -12;
#
## Avoid drawing shadows on dock/panel windows. This option is deprecated,
## you should use the *wintypes* option in your config file instead.
##
## no-dock-shadow = false
#
## Don't draw shadows on drag-and-drop windows. This option is deprecated, 
## you should use the *wintypes* option in your config file instead.
##
## no-dnd-shadow = false
#
## Red color value of shadow (0.0 - 1.0, defaults to 0).
## shadow-red = 0
#
## Green color value of shadow (0.0 - 1.0, defaults to 0).
## shadow-green = 0
#
## Blue color value of shadow (0.0 - 1.0, defaults to 0).
## shadow-blue = 0
#
## Do not paint shadows on shaped windows. Note shaped windows 
## here means windows setting its shape through X Shape extension. 
## Those using ARGB background is beyond our control. 
## Deprecated, use 
##   shadow-exclude = 'bounding_shaped'
## or 
##   shadow-exclude = 'bounding_shaped && !rounded_corners'
## instead.
##
## shadow-ignore-shaped = ''
#
## Specify a list of conditions of windows that should have no shadow.
##
## examples:
##   shadow-exclude = "n:e:Notification";
##
## shadow-exclude = []
shadow-exclude = [
  "name = 'Notification'",
  "class_g = 'Conky'",
  "class_g ?= 'Notify-osd'",
  "class_g = 'Cairo-clock'",
  "class_g = 'slop'",
  "class_g = 'Polybar'",
  "_GTK_FRAME_EXTENTS@:c"
];
#
## Specify a X geometry that describes the region in which shadow should not
## be painted in, such as a dock window region. Use 
##    shadow-exclude-reg = "x10+0+0"
## for example, if the 10 pixels on the bottom of the screen should not have shadows painted on.
##
## shadow-exclude-reg = "" 
#
## Crop shadow of a window fully on a particular Xinerama screen to the screen.
## xinerama-shadow-crop = false
#
#
##################################
##           Fading              #
##################################
#
#
## Fade windows in/out when opening/closing and when opacity changes,
##  unless no-fading-openclose is used.
## fading = false
fading = true;
#
## Opacity change between steps while fading in. (0.01 - 1.0, defaults to 0.028)
## fade-in-step = 0.028
fade-in-step = 0.03;
#
## Opacity change between steps while fading out. (0.01 - 1.0, defaults to 0.03)
## fade-out-step = 0.03
fade-out-step = 0.03;
#
## The time between steps in fade step, in milliseconds. (> 0, defaults to 10)
## fade-delta = 10
#
## Specify a list of conditions of windows that should not be faded.
## don't need this, we disable fading for all normal windows with wintypes: {}
fade-exclude = [
  "class_g = 'slop'",   # maim
  "class_g = 'flameshot'"   # maim


]

## Do not fade on window open/close.
## no-fading-openclose = false
#
## Do not fade destroyed ARGB windows with WM frame. Workaround of bugs in Openbox, Fluxbox, etc.
## no-fading-destroyed-argb = false
#
#
##################################
##   Transparency / Opacity      #
##################################
#
#
## Opacity of inactive windows. (0.1 - 1.0, defaults to 1.0)
## inactive-opacity = 1
inactive-opacity = 0.8;
#
## Opacity of window titlebars and borders. (0.1 - 1.0, disabled by default)
## frame-opacity = 1.0
frame-opacity = 0.8;
#
## Default opacity for dropdown menus and popup menus. (0.0 - 1.0, defaults to 1.0)
## menu-opacity = 1.0 
## menu-opacity is depreciated use dropdown-menu and popup-menu instead.
#
##If using these 2 below change their values in line 510 & 511 aswell
#popup_menu = { opacity = 0.8; }
#dropdown_menu = { opacity = 0.8; }
#
#
## Let inactive opacity set by -i override the '_NET_WM_OPACITY' values of windows.
## inactive-opacity-override = true
#inactive-opacity-override = false;
#
## Default opacity for active windows. (0.0 - 1.0, defaults to 1.0)
active-opacity = 0.95;
#
## Dim inactive windows. (0.0 - 1.0, defaults to 0.0)
# inactive-dim = 0.0
#
## Specify a list of conditions of windows that should always be considered focused.
## focus-exclude = []
#focus-exclude = [
#  "class_g = 'Cairo-clock'",
#  "class_g = 'Bar'",                    # lemonbar
#  "class_g = 'slop'"                    # maim
#];
#
## Use fixed inactive dim value, instead of adjusting according to window opacity.
## inactive-dim-fixed = 1.0
#
## Specify a list of opacity rules, in the format `PERCENT:PATTERN`, 
## like `50:name *= "Firefox"`. picom-trans is recommended over this. 
## Note we don't make any guarantee about possible conflicts with other 
## programs that set '_NET_WM_WINDOW_OPACITY' on frame or client windows.
## example:
##    opacity-rule = [ "80:class_g = 'URxvt'" ];
##
## opacity-rule = []
opacity-rule = [
#  "80:class_g     = 'Bar'",             # lemonbar
#  "100:class_g    = 'slop'",            # maim
#  "100:class_g    = 'XTerm'",
#  "100:class_g    = 'URxvt'",
#  "100:class_g    = 'kitty'",
#  "100:class_g    = 'Alacritty'",
    "90:class_g     = 'Polybar'"
#  "100:class_g    = 'code-oss'",
#  "100:class_g    = 'Meld'",
#  "70:class_g     = 'TelegramDesktop'",
#  "90:class_g     = 'Joplin'",
#  "100:class_g    = 'firefox'",
#  "100:class_g    = 'Thunderbird'"
];
#
#
##################################
##     Background-Blurring       #
##################################
#
#
## Parameters for background blurring, see the *BLUR* section for more information.
## blur-method = 
## blur-size = 12
##
## blur-deviation = false
#
## Blur background of semi-transparent / ARGB windows. 
## Bad in performance, with driver-dependent behavior. 
## The name of the switch may change without prior notifications.
##
## blur-background = true;
#
## Blur background of windows when the window frame is not opaque. 
## Implies:
##    blur-background 
## Bad in performance, with driver-dependent behavior. The name may change.
##
## blur-background-frame = false;
#
#
## Use fixed blur strength rather than adjusting according to window opacity.
## blur-background-fixed = false;
#
#
## Specify the blur convolution kernel, with the following format:
## example:
##   blur-kern = "5,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1";
##
## blur-kern = ''
## blur-kern = "3x3box";
#
blur: {
  # requires: https://github.com/ibhagwan/picom
  method = "dual_kawase";
  #method = "kernel";
  strength = 7;
  # deviation = 1.0;
  # kernel = "11x11gaussian";
  background = false;
  background-frame = false;
  background-fixed = false;
  kern = "3x3box";
}
#
## Exclude conditions for background blur.
blur-background-exclude = [
#  #"window_type = 'dock'",
#  #"window_type = 'desktop'",
#  #"class_g = 'URxvt'",
    "class_g = 'Polybar'"
#  #
#  # prevents picom from blurring the background
#  # when taking selection screenshot with `main`
#  # https://github.com/naelstrof/maim/issues/130
#  "class_g = 'slop'",
#  "_GTK_FRAME_EXTENTS@:c"
];
#
#
##################################
##       General Settings        #
##################################
#
## Daemonize process. Fork to background after initialization. Causes issues with certain (badly-written) drivers.
## daemon = false
#
## Specify the backend to use: `xrender`, `glx`, or `xr_glx_hybrid`.
## `xrender` is the default one.
##
experimental-backends = true;
backend = "glx";
##backend = "xrender";
#
#
## Enable/disable VSync.
## vsync = false
vsync = true
#
## Enable remote control via D-Bus. See the *D-BUS API* section below for more details.
## dbus = false
#
## Try to detect WM windows (a non-override-redirect window with no 
## child that has 'WM_STATE') and mark them as active.
##
## mark-wmwin-focused = false
#mark-wmwin-focused = true;
#
## Mark override-redirect windows that doesn't have a child window with 'WM_STATE' focused.
## mark-ovredir-focused = false
#mark-ovredir-focused = true;
#
## Try to detect windows with rounded corners and don't consider them 
## shaped windows. The accuracy is not very high, unfortunately.
##
## detect-rounded-corners = false
#detect-rounded-corners = true;
#
## Detect '_NET_WM_OPACITY' on client windows, useful for window managers
## not passing '_NET_WM_OPACITY' of client windows to frame windows.
##
## detect-client-opacity = false
detect-client-opacity = true;
#
## Specify refresh rate of the screen. If not specified or 0, picom will 
## try detecting this with X RandR extension.
##
## refresh-rate = 60
#refresh-rate = 0
#
## Limit picom to repaint at most once every 1 / 'refresh_rate' second to 
## boost performance. This should not be used with 
##   vsync drm/opengl/opengl-oml
## as they essentially does sw-opti's job already, 
## unless you wish to specify a lower refresh rate than the actual value.
##
## sw-opti = 
#
## Use EWMH '_NET_ACTIVE_WINDOW' to determine currently focused window, 
## rather than listening to 'FocusIn'/'FocusOut' event. Might have more accuracy, 
## provided that the WM supports it.
##
## use-ewmh-active-win = false
#
## Unredirect all windows if a full-screen opaque window is detected, 
## to maximize performance for full-screen windows. Known to cause flickering 
## when redirecting/unredirecting windows. paint-on-overlay may make the flickering less obvious.
##
## unredir-if-possible = false
#
## Delay before unredirecting the window, in milliseconds. Defaults to 0.
## unredir-if-possible-delay = 0
#
## Conditions of windows that shouldn't be considered full-screen for unredirecting screen.
## unredir-if-possible-exclude = []
#
## Use 'WM_TRANSIENT_FOR' to group windows, and consider windows 
## in the same group focused at the same time.
##
## detect-transient = false
#detect-transient = true
#
## Use 'WM_CLIENT_LEADER' to group windows, and consider windows in the same 
## group focused at the same time. 'WM_TRANSIENT_FOR' has higher priority if 
## detect-transient is enabled, too.
##
## detect-client-leader = false
detect-client-leader = true
#
## Resize damaged region by a specific number of pixels. 
## A positive value enlarges it while a negative one shrinks it. 
## If the value is positive, those additional pixels will not be actually painted 
## to screen, only used in blur calculation, and such. (Due to technical limitations, 
## with use-damage, those pixels will still be incorrectly painted to screen.) 
## Primarily used to fix the line corruption issues of blur, 
## in which case you should use the blur radius value here 
## (e.g. with a 3x3 kernel, you should use `--resize-damage 1`, 
## with a 5x5 one you use `--resize-damage 2`, and so on). 
## May or may not work with *--glx-no-stencil*. Shrinking doesn't function correctly.
##
## resize-damage = 1
#
## Specify a list of conditions of windows that should be painted with inverted color. 
## Resource-hogging, and is not well tested.
##
## invert-color-include = []
#
## GLX backend: Avoid using stencil buffer, useful if you don't have a stencil buffer. 
## Might cause incorrect opacity when rendering transparent content (but never 
## practically happened) and may not work with blur-background. 
## My tests show a 15% performance boost. Recommended.
##
## glx-no-stencil = false
#
## GLX backend: Avoid rebinding pixmap on window damage. 
## Probably could improve performance on rapid window content changes, 
## but is known to break things on some drivers (LLVMpipe, xf86-video-intel, etc.).
## Recommended if it works.
##
## glx-no-rebind-pixmap = false
#
## Disable the use of damage information. 
## This cause the whole screen to be redrawn everytime, instead of the part of the screen
## has actually changed. Potentially degrades the performance, but might fix some artifacts.
## The opposing option is use-damage
##
## no-use-damage = false
##use-damage = true (Causing Weird Black semi opaque rectangles when terminal is opened)
##Changing use-damage to false fixes the problem
#use-damage = false
#
## Use X Sync fence to sync clients' draw calls, to make sure all draw 
## calls are finished before picom starts drawing. Needed on nvidia-drivers 
## with GLX backend for some users.
##
xrender-sync-fence = false
#
## GLX backend: Use specified GLSL fragment shader for rendering window contents. 
## See `compton-default-fshader-win.glsl` and `compton-fake-transparency-fshader-win.glsl` 
## in the source tree for examples.
##
## glx-fshader-win = ''
#
## Force all windows to be painted with blending. Useful if you 
## have a glx-fshader-win that could turn opaque pixels transparent.
##
## force-win-blend = false
#
## Do not use EWMH to detect fullscreen windows. 
## Reverts to checking if a window is fullscreen based only on its size and coordinates.
##
## no-ewmh-fullscreen = false
#
## Dimming bright windows so their brightness doesn't exceed this set value. 
## Brightness of a window is estimated by averaging all pixels in the window, 
## so this could comes with a performance hit. 
## Setting this to 1.0 disables this behaviour. Requires --use-damage to be disabled. (default: 1.0)
##
## max-brightness = 1.0
#
## Make transparent windows clip other windows like non-transparent windows do,
## instead of blending on top of them.
##
## transparent-clipping = false
#
## Set the log level. Possible values are:
##  "trace", "debug", "info", "warn", "error"
## in increasing level of importance. Case doesn't matter. 
## If using the "TRACE" log level, it's better to log into a file 
## using *--log-file*, since it can generate a huge stream of logs.
##
## log-level = "debug"
log-level = "info";
#
## Set the log file.
## If *--log-file* is never specified, logs will be written to stderr. 
## Otherwise, logs will to written to the given file, though some of the early 
## logs might still be written to the stderr. 
## When setting this option from the config file, it is recommended to use an absolute path.
##
## log-file = '/path/to/your/log/file'
#
## Show all X errors (for debugging)
## show-all-xerrors = false
#
## Write process ID to a file.
## write-pid-path = '/path/to/your/log/file'
#
## Window type settings
## 
## 'WINDOW_TYPE' is one of the 15 window types defined in EWMH standard: 
##     "unknown", "desktop", "dock", "toolbar", "menu", "utility", 
##     "splash", "dialog", "normal", "dropdown_menu", "popup_menu", 
##     "tooltip", "notification", "combo", and "dnd".
## 
## Following per window-type options are available: ::
## 
##   fade, shadow:::
##     Controls window-type-specific shadow and fade settings.
## 
##   opacity:::
##     Controls default opacity of the window type.
## 
##   focus:::
##     Controls whether the window of this type is to be always considered focused. 
##     (By default, all window types except "normal" and "dialog" has this on.)
## #   full-shadow:::
##     Controls whether shadow is drawn under the parts of the window that you 
##     normally won't be able to see. Useful when the window has parts of it 
##     transparent, and you want shadows in those areas.
## 
##   redir-ignore:::
##     Controls whether this type of windows should cause screen to become 
##     redirected again after been unredirected. If you have unredir-if-possible
##     set, and doesn't want certain window to cause unnecessary screen redirection, 
##     you can set this to `true`.
##
wintypes:
{
#normal = { fade = true; shadow = false; opacity = 0.8}
#tooltip = { fade = true; shadow = true; opacity = 0.75; focus = true; full-shadow = false; };
  dock = { shadow = false; }
  
#dnd = { shadow = false; }
#  popup_menu = { opacity = 0.8; }
#dropdown_menu = { opacity = 0.8; }
};
```

# polybar

https://github.com/polybar/polybar

如果要显示不同模块的信息，需要装上对应的依赖

## 开机启动polybar

1. 在`~/.config/i3/config`中注释掉`i3status`部分
```config
#finds out, if available)
#bar {
#status_command i3status
#}
```

2. 创建脚本`~/.config/i3/polybar.sh`
```shell
killall -q polybar
while pgrep -x >/dev/null; do sleep 1; done
polybar
```

3. 在`~/.config/i3/config`中添加开机启动
```config
exec_always --no-startup-id ~/.config/i3/polybar.sh &
```

## 配置polybar

1. 创建配置文件`~/.config/polybar/config.ini`
2. 配置文件
```config
;==========================================================
;
;
;   ██████╗  ██████╗ ██╗  ██╗   ██╗██████╗  █████╗ ██████╗
;   ██╔══██╗██╔═══██╗██║  ╚██╗ ██╔╝██╔══██╗██╔══██╗██╔══██╗
;   ██████╔╝██║   ██║██║   ╚████╔╝ ██████╔╝███████║██████╔╝
;   ██╔═══╝ ██║   ██║██║    ╚██╔╝  ██╔══██╗██╔══██║██╔══██╗
;   ██║     ╚██████╔╝███████╗██║   ██████╔╝██║  ██║██║  ██║
;   ╚═╝      ╚═════╝ ╚══════╝╚═╝   ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝
;
;
;   To learn more about how to configure Polybar
;   go to https://github.com/polybar/polybar
;
;   The README contains a lot of information
;
;==========================================================

[colors]

background-alt = #373B41
primary = #F0C674
secondary = #8ABEB7
alert = #A54242
disabled = #707880

;foreground = ${xrdb:foreground:#ffff}
foreground = #ffff
;foreground = ${xrdb:background:#000}
background = #282A2E
;background = #2A2E
;background = #2A2E

;  _                    
; | |__   __ _ _ __ ___ 
; | '_ \ / _` | '__/ __|
; | |_) | (_| | |  \__ \
; |_.__/ \__,_|_|  |___/

[bar/bar]

enable-ipc=true
width = 100%
;height = 30pt
height = 30pt
;bottom = true
;border-left-size = 10pt
;border-right-size = 10pt
;border-color = #00000000

radius-top = 0
radius-bottom = 0
offset-y = 0

padding-left = 1
padding-right = 2

background = ${colors.background}
foreground = ${colors.foreground}

;line-size = 3

separator = |
separator-foreground = ${colors.foreground}
module-margin = 2


font-0=Comic Sans MS:size=12;4
;font-1=DFErGB Std:size=17;4
font-1=Kingnam Maiyuan:size=16;5
font-2=MaterialIcons-Regular:size=14;6
font-3=font-logos:size=10;4
font-4=FontAwesome:size=15;2
font-5=IPAGothic:size=11;2

modules-right =  filesystem cpu memory temperature wlan_original eth pulseaudio backlight time  
;powermenu mpd playerctl

; i3
modules-left =  xworkspaces xwindow 
;launcher i3
 scroll-up = i3wm-wsnext
 scroll-down = i3wm-wsprev
 wm-restack = i3

; bspwm
;modules-left = launcher bspwm xwindow
;scroll-up = bspwm-wsnext
;scroll-down = bspwm-wsprev
;wm-restack = bspwm
;override-redirect = false



;                      _       _           
;  _ __ ___   ___   __| |_   _| | ___  ___ 
; | '_ ` _ \ / _ \ / _` | | | | |/ _ \/ __|
; | | | | | | (_) | (_| | |_| | |  __/\__ \
; |_| |_| |_|\___/ \__,_|\__,_|_|\___||___/
;
                                         
[module/launcher]
type=custom/text
content = 
content-margin = 2
click-left=launcher
;The script above is to be found here : https://github.com/ngynLk/scripts

[module/updates]
type=custom/script
exec = yay -Qu | wc -l
exec-if = [[ $(yay -Qu | wc -l) != 0 ]]
format =   <label> update(s) available.
format-margin = 8
tail = true
interval = 30
click-left = xterm -e yay -Syu

[module/xwindow]
type = internal/xwindow
label = %title:0:75:...%
label-empty = Empty 
;label-empty-font = 0
;label-font = 0
format-margin = 1

[module/xworkspaces]
type = internal/xworkspaces

label-active = %name%
label-active-background = ${colors.background-alt}
label-active-underline= ${colors.foreground}
label-active-padding = 1

label-occupied = %name%
label-occupied-padding = 1

label-urgent = %name%
label-urgent-background = ${colors.alert}
label-urgent-padding = 1

label-empty = %name%
label-empty-foreground = ${colors.disabled}
label-empty-padding = 1




[network-base]
type = internal/network
interval = 1
format-connected = <label-connected>
format-disconnected = <label-disconnected>
label-disconnected = %{F#F0C674}%ifname%%{F#707880} disconnected

[module/wlan_original]
inherit = network-base
interface-type = wireless
label-connected =   %{F#F0C674} %essid%%{F-} %local_ip% 
;label-connected =   %{F#F0C674}%ifname%%{F-} %essid% %local_ip% 
label-disconnected =    %ifname%

[module/eth]
inherit = network-base
interface = enp6s0f3u2c4i2
;interface = eno1
interface-type = wired

label-connected = %{F#F0C674} WIRED%{F-} %local_ip%
label-disconnected =  %ifname%


[module/time]
type = internal/date

time = "%H:%M"
date = "%d %b"

label =  %time% - %date%
label-background = ${colors.background}


[module/pulseaudio]
type = internal/pulseaudio

format-volume = <ramp-volume><label-volume>
label-volume = %percentage:3:4%%
ramp-volume-foreground = ${colors.primary}
format-volume-background = ${colors.background}
use-ui-max = false

ramp-volume-0 = ""
ramp-volume-1 = ""
ramp-volume-2 = ""


label-muted = " muted"   
label-muted-background = ${colors.background}

[module/mpd]
type = internal/mpd
format-online-margin = 6
label-song-maxlen = 48
label-song = "%artist%: %title%"
format-online = " %{A1:xterm -e ncmpcpp:}<label-song>%{A}    <icon-prev><toggle><icon-next>"

icon-play = 
icon-pause = 
icon-prev = 
icon-next = 

[module/temperature]


type = internal/temperature
thermal-zone = 0
warn-temperature = 60

format =  <label>
format-warn = <ramp> <label-warn>

format-prefix = "TEMP "
format-prefix-foreground = ${colors.primary}

label =  "%temperature-c%"
label-warn = %temperature-c%
label-warn-color1 = ${colors.secondary}


ramp-0 = 
ramp-1 = 
ramp-2 = 


[module/playerctl]
type = custom/script
format-margin = 4
format-prefix = " "
exec = playerctl_status
exec-if = [[ "$(playerctl -l)" != "No players found" ]] && echo "0"
tail = true
interval = 0

[module/memory]
type = internal/memory
interval = 2
format-prefix = "RAM "
format-prefix-foreground = ${colors.primary}
label = %percentage_used:2%%

[module/cpu]
type = internal/cpu
interval = 2
format-prefix = "CPU "
format-prefix-foreground = ${colors.primary}
label = %percentage:2%%

[module/filesystem]
type = internal/fs
interval = 25

mount-0 = /
label-mounted =  %{F#F0C674}%mountpoint%%{F-} %percentage_used%%

;
label-unmounted =  %mountpoint% not mounted
label-unmounted-foreground = ${colors.disabled}


[module/backlight]
type = internal/backlight

; Use the following command to list available cards:
; $ ls -1 /sys/class/backlight/
card = nvidia_0

; Use the `/sys/class/backlight/.../actual-brightness` file
; rather than the regular `brightness` file.
; Defaults to true unless the specified card is an amdgpu backlight.
; New in version 3.6.0
use-actual-brightness = true

; Enable changing the backlight with the scroll wheel
; NOTE: This may require additional configuration on some systems. Polybar will
; write to `/sys/class/backlight/${self.card}/brightness` which requires polybar
; to have write access to that file.
; DO NOT RUN POLYBAR AS ROOT. 
; The recommended way is to add the user to the
; `video` group and give that group write-privileges for the `brightness` file.
; See the ArchWiki for more information:
; https://wiki.archlinux.org/index.php/Backlight#ACPI
; Default: false
enable-scroll = false

format-prefix = " "
format-prefix-foreground = ${colors.primary}

#format = <label>

; Available tokens:
;   %percentage% (default)
label = %percentage%%









[settings]
screenchange-reload = true
;compositing-background = xor
;compositing-background = screen
;compositing-foreground = source
;compositing-border = over
pseudo-transparency = false

[global/wm]
margin-top = 0
margin-bottom = 0

; vim:ft=dosini
```


# rofi 

## 安装rofi

https://github.com/davatorium/rofi

## 配置rofi

https://github.com/davatorium/rofi/blob/next/CONFIG.md

创建配置文件到`~/.config/rofi/config.rasi`
```cmd
rofi -upgrade-config
```
## 更换主题

https://github.com/davatorium/rofi-themes/tree/master/User%20Themes

下载想用的主题，主题文件放到`~/.config/rofi/`目录下

## rofi代替dmenu

在`~/.config/i3/config`中添加一行：

```config
bindsym $mod+d exec --no-startup-id rofi -theme slate.rasi -show combi -show-icons
```

## rofi配置文件

```config
configuration {
	modi: "window,run,ssh,combi";
	width: 60;
	lines: 10;
/*	columns: 1;*/
	font: "mono 12";
/*	bw: 1;*/
/*	location: 0;*/
/*	padding: 5;*/
/*	yoffset: 0;*/
/*	xoffset: 0;*/
/*	fixed-num-lines: true;*/
/*	show-icons: false;*/
/*	terminal: "rofi-sensible-terminal";*/
/*	ssh-client: "ssh";*/
/*	ssh-command: "{terminal} -e {ssh-client} {host}";*/
/*	run-command: "{cmd}";*/
/*	run-list-command: "";*/
/*	run-shell-command: "{terminal} -e {cmd}";*/
/*	window-command: "xkill -id {window}";*/
/*	window-match-fields: "all";*/
/*	drun-icon-theme: ;*/
/*	drun-match-fields: "name,generic,exec,categories";*/
/*	disable-history: false;*/
/*	sort: false;*/
/*	levenshtein-sort: false;*/
/*	case-sensitive: false;*/
/*	cycle: true;*/
/*	sidebar-mode: false;*/
/*	eh: 1;*/
/*	auto-select: false;*/
/*	parse-hosts: false;*/
/*	parse-known-hosts: true;*/
	combi-modi: "drun,run";
/*	matching: "normal";*/
/*	tokenize: true;*/
/*	m: "-5";*/
/*	line-margin: 2;*/
/*	line-padding: 1;*/
/*	filter: ;*/
/*	separator-style: "dash";*/
/*	hide-scrollbar: false;*/
/*	fullscreen: false;*/
/*	fake-transparency: false;*/
/*	dpi: -1;*/
/*	threads: 0;*/
/*	scrollbar-width: 8;*/
/*	scroll-method: 0;*/
/*	fake-background: "screenshot";*/
/*	window-format: "{w}    {i}{c}   {t}";*/
/*	click-to-exit: true;*/
/*	show-match: true;*/
/*	theme: ;*/
/*	color-normal: ;*/
/*	color-urgent: ;*/
/*	color-active: ;*/
/*	color-window: ;*/
/*	max-history-size: 25;*/
/*	combi-hide-mode-prefix: false;*/
/*	pid: "/run/user/1000/rofi.pid";*/
/*	display-window: ;*/
/*	display-windowcd: ;*/
/*	display-run: ;*/
/*	display-ssh: ;*/
/*	display-drun: ;*/
/*	display-combi: ;*/
/*	display-keys: ;*/
/*	kb-primary-paste: "Control+V,Shift+Insert";*/
/*	kb-secondary-paste: "Control+v,Insert";*/
/*	kb-clear-line: "Control+w";*/
/*	kb-move-front: "Control+a";*/
/*	kb-move-end: "Control+e";*/
/*	kb-move-word-back: "Alt+b";*/
/*	kb-move-word-forward: "Alt+f";*/
/*	kb-move-char-back: "Left,Control+b";*/
/*	kb-move-char-forward: "Right,Control+f";*/
/*	kb-remove-word-back: "Control+Alt+h,Control+BackSpace";*/
/*	kb-remove-word-forward: "Control+Alt+d";*/
/*	kb-remove-char-forward: "Delete,Control+d";*/
/*	kb-remove-char-back: "BackSpace,Control+h";*/
/*	kb-remove-to-eol: "Control+k";*/
/*	kb-remove-to-sol: "Control+u";*/
/*	kb-accept-entry: "Control+j,Control+m,Return,KP_Enter";*/
/*	kb-accept-custom: "Control+Return";*/
/*	kb-accept-alt: "Shift+Return";*/
/*	kb-delete-entry: "Shift+Delete";*/
/*	kb-mode-next: "Shift+Right,Control+Tab";*/
/*	kb-mode-previous: "Shift+Left,Control+ISO_Left_Tab";*/
/*	kb-row-left: "Control+Page_Up";*/
/*	kb-row-right: "Control+Page_Down";*/
/*	kb-row-up: "Up,Control+p,ISO_Left_Tab";*/
/*	kb-row-down: "Down,Control+n";*/
/*	kb-row-tab: "Tab";*/
/*	kb-page-prev: "Page_Up";*/
/*	kb-page-next: "Page_Down";*/
/*	kb-row-first: "Home,KP_Home";*/
/*	kb-row-last: "End,KP_End";*/
/*	kb-row-select: "Control+space";*/
/*	kb-screenshot: "Alt+S";*/
/*	kb-toggle-case-sensitivity: "grave,dead_grave";*/
/*	kb-toggle-sort: "Alt+grave";*/
/*	kb-cancel: "Escape,Control+g,Control+bracketleft";*/
/*	kb-custom-1: "Alt+1";*/
/*	kb-custom-2: "Alt+2";*/
/*	kb-custom-3: "Alt+3";*/
/*	kb-custom-4: "Alt+4";*/
/*	kb-custom-5: "Alt+5";*/
/*	kb-custom-6: "Alt+6";*/
/*	kb-custom-7: "Alt+7";*/
/*	kb-custom-8: "Alt+8";*/
/*	kb-custom-9: "Alt+9";*/
/*	kb-custom-10: "Alt+0";*/
/*	kb-custom-11: "Alt+exclam";*/
/*	kb-custom-12: "Alt+at";*/
/*	kb-custom-13: "Alt+numbersign";*/
/*	kb-custom-14: "Alt+dollar";*/
/*	kb-custom-15: "Alt+percent";*/
/*	kb-custom-16: "Alt+dead_circumflex";*/
/*	kb-custom-17: "Alt+ampersand";*/
/*	kb-custom-18: "Alt+asterisk";*/
/*	kb-custom-19: "Alt+parenleft";*/
/*	kb-select-1: "Super+1";*/
/*	kb-select-2: "Super+2";*/
/*	kb-select-3: "Super+3";*/
/*	kb-select-4: "Super+4";*/
/*	kb-select-5: "Super+5";*/
/*	kb-select-6: "Super+6";*/
/*	kb-select-7: "Super+7";*/
/*	kb-select-8: "Super+8";*/
/*	kb-select-9: "Super+9";*/
/*	kb-select-10: "Super+0";*/
/*	ml-row-left: "ScrollLeft";*/
/*	ml-row-right: "ScrollRight";*/
/*	ml-row-up: "ScrollUp";*/
/*	ml-row-down: "ScrollDown";*/
/*	me-select-entry: "MousePrimary";*/
/*	me-accept-entry: "MouseDPrimary";*/
/*	me-accept-custom: "Control+MouseDPrimary";*/
}

```

# i3lock

1. 默认的i3lock

2. i3lock-color
https://github.com/Raymo111/i3lock-color

3. betterlockscreen (最终使用)
https://github.com/betterlockscreen/betterlockscreen

# 壁纸

自动更换壁纸

1. 创建 python 文件

```python
import os
import glob
import time

bg_dir = '/home/wadekiny/Pictures/background/'
time_cycle = 1000
bg_list = glob.glob(bg_dir + '*.jpg') + glob.glob(bg_dir + '*.png')

while True:
    bg_list = glob.glob(bg_dir + '*.jpg') + glob.glob(bg_dir + '*.png')
    for pic_name in bg_list:
        print(pic_name)
        os.system('feh --bg-fill '+ pic_name)
        time.sleep(time_cycle)
```

2. 开机启动 

`~/.config/i3/config`中添加一行

```config
exec_always --no-startup-id python3 ~/.config/i3/wallpic.py
```




# 音量

## 设置默认声卡
在使用amixer设置音量时，报错: `amixer: Unable to find simple control 'Master' 0`

1. 通过`alsamixer`命令可以查看当前声卡，调节音频
2. 查看声卡相关信息：
```cmd
 wadekiny-R7P <~> [16:35:29]
 >> aplay -l
**** List of PLAYBACK Hardware Devices ****
card 0: NVidia [HDA NVidia], device 3: HDMI 0 [HDMI 0]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
card 0: NVidia [HDA NVidia], device 7: HDMI 1 [HDMI 1]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
card 0: NVidia [HDA NVidia], device 8: HDMI 2 [HDMI 2]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
card 0: NVidia [HDA NVidia], device 9: HDMI 3 [HDMI 3]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
card 0: NVidia [HDA NVidia], device 10: HDMI 4 [HDMI 4]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
card 1: Generic [HD-Audio Generic], device 0: ALC257 Analog [ALC257 Analog]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
```
所以，在aplay -l 里面选择声卡1,设备ID为0的声卡。

3. 把下列配置添加到系统级别的 `/etc/asound.conf` 或用户级别的 `~/.asoundrc` 文件。如果文件不存在，可以手动创建。其中的各个ID，请根据实际情况调整：

```config
defaults.pcm.card 1
defaults.pcm.device 0
defaults.ctl.card 1
```

`pcm`选项决定用来播放音频的设备，而`ctl`选项决定那个声卡能够由控制工具（如 alsamixer）使用。

## 配置快捷键

在`~/.config/i3/config`中添加：

```config
bindsym XF86AudioRaiseVolume exec amixer set  Master 1dB+
bindsym XF86AudioLowerVolume exec amixer set  Master 1dB-
bindsym XF86AudioMute exec amixer -D pulse set Master toggle 

```

# 亮度

在`~/.config/i3/config`中添加：

```config
bindsym XF86MonBrightnessUp exec "xbacklight -inc 10; notify-send 'brightness up'"
bindsym XF86MonBrightnessDown exec "xbacklight -dec 10; notify-send 'brightness down'"
```


# 触摸板

## 轻击触摸板实现点击功能

编写脚本文件`~/.config/i3/tap2click.sh`，在i3的配置文件中添加一行：

```config
exec_always --no-startup-id ~/.config/i3/tap2click.sh &
```

```shell
#!/bin/bash

# Get id of touchpad and the id of the field corresponding to
# tapping to click
id=`xinput list | grep "Touchpad" | cut -d'=' -f2 | cut -d'[' -f1`
tap_to_click_id=`xinput list-props $id | \
                      grep "Tapping Enabled (" \
                      | cut -d'(' -f2 | cut -d')' -f1`

# Set the property to true
xinput --set-prop $id $tap_to_click_id 1
```

## 实现反向滚动


编写脚本文件`~/.config/i3/inverse-scroll.sh`，在i3的配置文件中添加一行：

```config
exec_always --no-startup-id ~/.config/i3/inverse-scroll.sh &
```

```shell
#!/bin/bash

# Get id of touchpad and the id of the field corresponding to
# natural scrolling
id=`xinput list | grep "Touchpad" | cut -d'=' -f2 | cut -d'[' -f1`
natural_scrolling_id=`xinput list-props $id | \
                      grep "Natural Scrolling Enabled (" \
                      | cut -d'(' -f2 | cut -d')' -f1`

# Set the property to true
xinput --set-prop $id $natural_scrolling_id 1
```


